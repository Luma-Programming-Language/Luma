@module "common"

pub const Opcode -> enum {
  OP_PUSH,  
  OP_POP,   
  OP_DUP,   
  OP_ADD,   
  OP_SUB,   
  OP_MUL,   
  OP_DIV,   
  OP_EXP,   
  OP_MOD,
  OP_PRINT, 
  OP_JMP,   
  OP_JZ,    
  OP_JNZ,   
  OP_LT,    
  OP_EQ,    
  OP_NEG,   
  OP_HALT   
};

pub const TokenKind -> enum {
  Number,
  LParen,
  RParen,
  At,
  Semi,

  Plus,
  Minus,
  Star,
  Slash,
  Carrot,
  Mod,

  EOF,
};

pub const VM -> struct {
  stack: *int, 
  program: *byte,
  sp: int, // stack pointer
  pc: int, // program counter
};

pub const Lexer -> struct {
  line: int, col: int,
  current: *byte,
  src: *byte,
};

pub const Token -> struct {
  val: *byte,
  kind: int,
  len: int,
};
